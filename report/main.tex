\documentclass[a4paper,twoside,12pt]{article}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{enumerate}
\usepackage[shortlabels]{enumitem}
\usepackage{fullpage}
\usepackage{setspace}
\usepackage{graphicx}
\usepackage{import}
\usepackage{amsmath}
\usepackage{mathabx}
\usepackage{icomma}
\usepackage{booktabs}
\usepackage{ftcap}
\usepackage{lipsum}
\usepackage{url}
\usepackage[binary-units]{siunitx}
\usepackage{epstopdf}
\usepackage{hyperref}
\usepackage{subcaption}

%\usepackage[sorting=none]{biblatex}

\begin{document}
\onehalfspacing%
\thispagestyle{empty}
\begin{flushleft}
 \underline{Sakari} Matias Kapanen\hfill
 \texttt{sakari.m.kapanen@student.jyu.fi}
\end{flushleft}
\vfill
\begin{center}
\textsc{\LARGE A Monte Carlo method for simulating the neutral density profile in an ECR ion source}
\end{center}
\vfill
% Palautuspvm
Supervisor: Taneli Kalvas\\
\vfill
\begin{abstract}
 \noindent
    Lorem ipsum
\end{abstract}
\clearpage%

\setlength{\parindent}{0pt}
\setlength{\parskip}{12pt}

\setcounter{page}{1}

\section{Introduction}
In electron cyclotron resonance ion sources (ECRIS), it is crucial to keep the neutral density low enough to achieve efficient production of high ion charge states. The removal of neutrals is usually realized using turbo vacuum pumps. There are usually vacuum gauges installed in some spots to monitor the pressure.

The gauges, however, cannot capture local deviations in the neutral density. Therefore, the problem was approached by means of numerical simulation. The goal of this research training project was to produce a Monte Carlo code which could be used for that purpose.

It was assumed that the flow of neutrals is in the molecular flow regime, i.e. there is no direct interaction between the neutrals. The groundwork for the free molecular flow simulation was laid earlier in the author's BSc thesis~\cite{kapanen:bsc}.

There certainly have been similar simulation models developed earlier, typically based on the Particle-in-Cell method. Those simulations feature a dynamic model of the ECR plasma, which leads to great computational complexity.

In this project the idea of a simpler, quasi-stationary plasma model was probed. Such a model has the advantage of lower complexity because one only has mutually non-interacting neutrals as test particles. The independence of the test particles also means that the computation is easily parallelizable and performance gains can be had from running on multiprocessor systems.

The bulk of the work in this project consisted of implementing a suitable plasma model and implementing neutral ``ray tracing'' in a real CAD geometry.

\section{Theoretical background}
In a typical ECR ion source, a plasma is formed by injecting neutral gas particles into a vacuum chamber and coupling RF energy to it at the frequency of several $\si{\giga\hertz}$.

The plasma in an ECR ion source is a typical example of a laboratory plasma, with an electron density of $\sim\SI{e11}{\per\centi\metre}$. Due to the electron cyclotron resonance heating, there is a population of electrons with a high temperature of $\sim\SI{10}{\kilo\electronvolt}$. Outside the region where the cyclotron resonance heating takes place, there is also a population of colder neutrals at xx eV. The total electron energy distribution is thus often approximated by a ``double Maxwell'' distribution. GELLER

Given that the ion confinement time in the magnetic bottle is long enough to achieve thermalization, the ion energy distribution can also be assumed as Maxwellian. Typical ion temperatures are in the range of xx-yy eV GELLER

\subsection{Plasma processes}

This section lists the collision processes where the plasma and neutrals are involved. The focus is purposely kept on reactions concerning the neutrals. lso, only the ``single'' versions of these processes are covered as these dominate over the multiple counterparts in most cases. The formulae for the respective cross sections or rate coefficients are also listed.

Using the cross section $\sigma$, the rate coefficient is then defined as $\langle \sigma(v_r) v_r \rangle$ where $v_r$ is the speed of the target particle relative to the bombarding particles. Considering a Maxwellian population of bombarding particles whose velocities have a uniform direction distribution, the relative speed can be written as
\begin{equation}
    v_r = \sqrt{v_x^2 + v_y^2 + (v_z - v_t)^2}
\end{equation}
where $v_t$ is the speed of the target particle and $v_{\{x, y, z\}}$ are the velocity components of the bombarding particle. Here the direction of the target particle motion was chosen to be along the $z$ axis. This choice is arbitrary due to the symmetry of the velocity distribution of the projectile particles.

Now the rate coefficient can be calculated as an integral over the projectile particle velocity space:
\begin{equation}
    \langle \sigma v_r \rangle = \int\limits_{-\infty}^\infty \int\limits_{-\infty}^\infty \int\limits_{-\infty}^\infty v_r \sigma(v_r) f(v_x, v_y, v_z)\,\mathrm{d}v_x\,\mathrm{d}v_y\,\mathrm{d}v_z,
\end{equation}
where $f(v_x, v_y, v_z)$ is the velocity distribution of the projectile particles. In the context of this simulation, $f$ is the Maxwellian velocity distribution:
\begin{equation}
    f(v_x, v_y, v_z) = \left(\frac{m}{2\pi kT}\right)^{3/2} \exp \left[ -\frac{m(v_x^2 + v_y^2 + v_z^2)}{2kT} \right]
\end{equation}
where $m$ is the projectile particle mass, $k$ is the Boltzmann constant and $T$ is the temperature of the projectile particle population.

\subsubsection{Electron ionization}
Electron (impact) ionization is a process where an energetic electron positively ionizes an atom or an ion by knocking off an electron bound to a shell:
\[
    X^{+n} + e \rightarrow A^{+(n+1)} + 2e,
\]
where $X$ is the original atom ($n=0$) or ion and $e$ is an electron.

There have been many approximations of the electron ionization cross sections, most famously the Lotz equation~CITATION. A more convenient approximation was found in~\cite{recommended_ionization} and is used as a fit function
\begin{equation}
    \label{eq:ionization_fit}
    \sigma(E) = \frac{1}{IE} \left[ A \ln \left(\frac{E}{I}\right) + \sum\limits_{i=1}^N
    B_i \left(1-\frac{I}{E}\right)^i \right]
\end{equation}
where $E$ is the electron energy, $I$ is the ionization potential of the atom or ion and $A$, $B_i$ are fit parameters depending on the atom or ion. The fit parameters are given in~\cite{recommended_ionization}. Notice that the cross section is given as a function of the electron energy instead of the relative velocity --- however, because the electron speed is undoubtedly much greater than the target particle speed, this is a perfectly valid approximation.

For example, the fit parameters for argon neutrals are listed in table~\ref{table:argon_ionization}.
\begin{table}
    \centering
    \caption{Fit parameters of equation~\ref{eq:ionization_fit} for argon neutrals~\cite{recommended_ionization}.}
    \label{table:argon_ionization}
    \begin{tabular}{cccccccc}
        \toprule
        $I\,(\si{\electronvolt})$ & $A$ & $B_1$ & $B_2$ & $B_3$ & $B_4$ & $B_5$ & condition\\
        \midrule
        15.8 & 2.532 & -2.672 & 2.543 & -0.769 & 0.008 & 0.006 & \\
        15.8 & 4.337 & 3.092 & -21.253 & 14.626 & 0.018 & 0.031 & $E > 4.13I$ \\
        \bottomrule
    \end{tabular}
\end{table}

\subsubsection{Charge exchange}
Charge exchange is a process where an ion $X$ exchanges an electron with another ion or an atom $X$:
\[
    X^{+m} + Y^{+n} \rightarrow X^{+(m-1)} + Y^{+(n+1)}.
\]
For example, $X$ being a $+1$ ion and $Y$ an atom:
\[
    X^{+1} + Y^0 \rightarrow X^{0} + Y^{+1}.
\]

A famous approximation for the single charge exchange cross section is the one proposed by Salzborn et al. and used in~\cite{cex} as
\begin{equation}
    \label{eq:cex}
    \sigma_{q, q-1} = 1.43 \times 10^{-12} q^{1.17} I^{-2.76}\,(\si{\centi\metre\squared}),
\end{equation}
where $q$ is the initial charge of the projectile and $I$ is the ionization potential of the target particle in $\si{\electronvolt}$.

\subsubsection{Recombination}

\subsection{Ion confinement}

\subsection{Knudsen's cosine law}

\subsection{Thermal accommodation}

\section{Numerical methods and tools}

\subsection{Monte Carlo test particle simulation}

\subsubsection{Monte Carlo collisions}

\subsubsection{Decay channel sampling}

\subsection{Single electron simulation}

\subsection{Calculating the confinement time}

\subsection{Software packages}

\section{Results}

\subsection{Convergence test}

\subsection{Stationary density distribution}

\subsection{Time dependent density distribution}

\section{Conclusions}

\clearpage

\bibliographystyle{unsrt}
\bibliography{references}

\end{document}

